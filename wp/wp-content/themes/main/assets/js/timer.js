class CountdownTimer{constructor(t,e,i){this._deadline=t,this._cbChange=e,this._cbComplete=i,this._timerId=null,this._out={days:"",hours:"",minutes:"",seconds:"",daysTitle:"",hoursTitle:"",minutesTitle:"",secondsTitle:""},this._start()}static declensionNum(t,e){return e[t%100>4&&t%100<20?2:[2,0,1,1,1,2][t%10<5?t%10:5]]}_start(){this._calc(),this._timerId=setInterval(this._calc.bind(this),1e3)}_calc(){let t=this._deadline-new Date,e=t>0?Math.floor(t/1e3/60/60/24):0,i=t>0?Math.floor(t/1e3/60/60)%24:0,n=t>0?Math.floor(t/1e3/60)%60:0,o=t>0?Math.floor(t/1e3)%60:0;this._out.days=e<10?"0"+e:e,this._out.hours=i<10?"0"+i:i,this._out.minutes=n<10?"0"+n:n,this._out.seconds=o<10?"0"+o:o,this._out.daysTitle=CountdownTimer.declensionNum(e,["день","дня","дней"]),this._out.hoursTitle=CountdownTimer.declensionNum(i,["час","часа","часов"]),this._out.minutesTitle=CountdownTimer.declensionNum(n,["минута","минуты","минут"]),this._out.secondsTitle=CountdownTimer.declensionNum(o,["секунда","секунды","секунд"]),this._cbChange&&this._cbChange(this._out),t<=0&&(clearInterval(this._timerId),this._cbComplete&&this._cbComplete())}}let timers=document.querySelectorAll(".timer");function initTimer(t,e,i){new CountdownTimer(e,(e=>{let i=t.querySelector(".timer__item-days"),n=t.querySelector(".timer__item-hours"),o=t.querySelector(".timer__item-minutes"),s=t.querySelector(".timer__item-seconds");i.textContent=e.days,n.textContent=e.hours,o.textContent=e.minutes,s.textContent=e.seconds,i.nextElementSibling.textContent=e.daysTitle,n.nextElementSibling.textContent=e.hoursTitle,o.nextElementSibling.textContent=e.minutesTitle,s.nextElementSibling.textContent=e.secondsTitle}))}function updateCookieDate(t,e){document.cookie=`timer_${t}=${new Date(Date.now()+e)}; path=/`}function getCookie(t){let e=document.cookie.match(new RegExp(`(?:^|; )${t}=([^;]*)`));return e?e[1]:null}timers.forEach((t=>{let e=t.getAttribute("data-date-id");if(e){if(t.getAttribute("data-date")){let[i,n,o]=t.getAttribute("data-date").split("-");initTimer(t,new Date(i,n-1,o),e)}if(t.getAttribute("data-period")){let[i,n=0,o=0,s=0]=t.getAttribute("data-period").split("-"),r=864e5*i+36e5*n+6e4*o+1e3*s,l=getCookie(`timer_${e}`);l?new Date(l).getTime()<Date.now()&&null!=t.getAttribute("data-repeat")?(updateCookieDate(e,r),initTimer(t,new Date(Date.now()+r),e)):initTimer(t,new Date(l),e):(updateCookieDate(e,r),initTimer(t,new Date(Date.now()+r),e))}}}));